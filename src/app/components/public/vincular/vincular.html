<div class="vincular-container">
    <div class="vincular-card fade-in">

        <!-- Loading State -->
        <div *ngIf="isLoading" class="loading-state">
            <div class="spinner"></div>
            <p>Verificando negocio...</p>
        </div>

        <!-- Error State -->
        <div *ngIf="!isLoading && errorMsg" class="error-state">
            <div class="icon-error">‚ùå</div>
            <h3>Oops</h3>
            <p>{{ errorMsg }}</p>
        </div>

        <!-- Valid State: Pending Connection -->
        <div *ngIf="!isLoading && isValid && !linkSuccess" class="action-state">
            <div class="icon-connect">üîó</div>
            <h2>Vincular Dispositivo</h2>
            <p>Est√°s a punto de conectar tu tel√©fono o sesi√≥n web para operar con:</p>
            <h3 class="business-name">{{ businessName }}</h3>
            <p class="desc-small">Al confirmar, el asistente IA de este negocio quedar√° vinculado a tu dispositivo.</p>

            <button class="btn-confirm" (click)="confirmConnection()" [disabled]="isLinking"
                [class.loading]="isLinking">
                <span *ngIf="!isLinking">Quiero Vincularme</span>
                <span *ngIf="isLinking">Aprobando conexi√≥n...</span>
            </button>
        </div>

        <!-- Success State -->
        <div *ngIf="linkSuccess" class="success-state fade-in">
            <div class="icon-success">‚úÖ</div>
            <h2>¬°Vinculaci√≥n Exitosa!</h2>
            <p>Tu dispositivo ahora est√° emparejado correctamente con <strong>{{ businessName }}</strong>.</p>
            <p class="desc-small">El asistente virtual o panel de pedidos ya puede comunicarse con vos.</p>
            <p class="safe-close">Ya puedes cerrar esta ventana.</p>
        </div>

    </div>
</div>