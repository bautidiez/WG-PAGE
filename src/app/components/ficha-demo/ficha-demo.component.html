<div class="demo-page">

    <!-- HEADER -->
    <header class="demo-header">
        <a routerLink="/" class="back-link">{{ t('demo.backLink') }}</a>
        <div class="demo-title-wrap">
            <span class="demo-badge">{{ t('demo.badge') }}</span>
            <h1 class="demo-title">{{ t('demo.title') }}</h1>
            <p class="demo-subtitle">{{ t('demo.subtitle') }}</p>
        </div>
    </header>

    <!-- MAIN LAYOUT -->
    <main class="demo-main">

        <!-- LEFT ‚Äî FORM -->
        <section class="demo-form-panel">
            <div class="form-card">

                <!-- STEP 1: B√ÅSICOS Y PRODUCTOS -->
                <div *ngIf="currentStep === 1" class="wizard-step fade-in">
                    <!-- DATOS B√ÅSICOS -->
                    <div class="form-section">
                        <h3 class="section-heading"><span class="label-icon">üè¢</span> Datos B√°sicos</h3>
                        <div class="form-row">
                            <div class="form-group flex-2">
                                <label class="form-label">Nombre del Negocio</label>
                                <input type="text" class="form-input" [(ngModel)]="modernData.nombre"
                                    placeholder="Ej: La Pizzer√≠a de Pepe">
                            </div>
                            <div class="form-group flex-1">
                                <label class="form-label">Rubro</label>
                                <div class="custom-select-wrapper">
                                    <select class="form-select" [(ngModel)]="modernData.rubro">
                                        <option value="Gastronom√≠a">Gastronom√≠a</option>
                                        <option value="Indumentaria / Moda">Indumentaria / Moda</option>
                                        <option value="Centro de Salud / Kinesiolog√≠a">Centro de Salud</option>
                                        <option value="Est√©tica / Peluquer√≠a">Est√©tica / Peluquer√≠a</option>
                                        <option value="Taller Mec√°nico / Automotriz">Taller Mec√°nico</option>
                                        <option value="Servicios Generales">Servicios</option>
                                        <option value="Otro">Otro</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ubicaci√≥n</label>
                            <input type="text" class="form-input" [(ngModel)]="modernData.ubicacion"
                                placeholder="Ej: Av. Corrientes 1234, CABA">
                        </div>
                    </div>

                    <!-- PRODUCTOS DIN√ÅMICOS -->
                    <div class="form-section">
                        <h3 class="section-heading"><span class="label-icon">üìã</span> Productos o Servicios</h3>
                        <p class="section-desc">Escrib√≠ brevemente tus principales opciones (ej: "Pizza Muzzarella" y
                            "5000").</p>

                        <div class="file-upload-container-top">
                            <p class="section-desc">O si prefer√≠s, sub√≠ tu men√∫/cat√°logo completo en formato PDF, Word o
                                Excel.</p>
                            <input type="file" id="menuFile" (change)="onFileSelected($event)"
                                accept=".pdf,.doc,.docx,.xls,.xlsx" class="file-input-hidden">
                            <label for="menuFile" class="btn-upload">
                                <span class="upload-icon">üìÅ</span> {{ selectedFileName || 'Seleccionar Archivo...' }}
                            </label>
                        </div>

                        <div class="separator-text">o cargalos manualmente</div>

                        <div class="product-rows-container mt-2">
                            <div class="product-row" *ngFor="let prod of modernData.productosList; let i = index">
                                <input type="text" class="form-input flex-2" [(ngModel)]="prod.nombre"
                                    placeholder="Nombre del producto/servicio">
                                <input type="text" class="form-input flex-1 amount-input" [(ngModel)]="prod.precio"
                                    placeholder="Precio (opcional)">
                                <button class="btn-remove" (click)="quitarProducto(i)" title="Quitar fila">‚úï</button>
                            </div>
                        </div>

                        <button class="btn-add-row" (click)="agregarProducto()">
                            <span class="plus-icon">+</span> Agregar Producto o Servicio
                        </button>
                    </div>

                    <div class="wizard-nav right">
                        <button class="btn-next" (click)="nextStep()">Siguiente ‚Üí</button>
                    </div>
                </div> <!-- END STEP 1 -->

                <!-- STEP 2: HORARIOS -->
                <div *ngIf="currentStep === 2" class="wizard-step fade-in">
                    <!-- HORARIOS POR D√çA -->
                    <div class="form-section">
                        <div class="section-heading-row">
                            <h3 class="section-heading"><span class="label-icon">üïê</span> Horarios de Apertura</h3>
                            <button class="btn-text-action" (click)="aplicarHorarioTodos()"
                                title="Copia el Lunes a Mar-Vie">
                                Aplicar Lunes a todos
                            </button>
                        </div>

                        <div class="checkbox-group" *ngFor="let dia of modernData.dias">
                            <label class="checkbox-header">
                                <input type="checkbox" [(ngModel)]="dia.activo">
                                <span class="custom-checkbox"></span>
                                <span class="checkbox-label" [class.text-disabled]="!dia.activo">{{ dia.nombre }}</span>
                            </label>
                            <div class="time-inputs" *ngIf="dia.activo">
                                <select class="form-select time-select" [(ngModel)]="dia.startH">
                                    <option value="" disabled>HH</option>
                                    <option *ngFor="let h of hoursList" [value]="h">{{h}}</option>
                                </select>
                                <span>:</span>
                                <select class="form-select time-select" [(ngModel)]="dia.startM">
                                    <option value="" disabled>MM</option>
                                    <option *ngFor="let m of minutesList" [value]="m">{{m}}</option>
                                </select>
                                <span class="time-sep">a</span>
                                <select class="form-select time-select" [(ngModel)]="dia.endH">
                                    <option value="" disabled>HH</option>
                                    <option *ngFor="let h of hoursList" [value]="h">{{h}}</option>
                                </select>
                                <span>:</span>
                                <select class="form-select time-select" [(ngModel)]="dia.endM">
                                    <option value="" disabled>MM</option>
                                    <option *ngFor="let m of minutesList" [value]="m">{{m}}</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="wizard-nav space-between">
                        <button class="btn-prev" (click)="prevStep()">‚Üê Atr√°s</button>
                        <button class="btn-next" (click)="nextStep()">Siguiente ‚Üí</button>
                    </div>
                </div> <!-- END STEP 2 -->

                <!-- STEP 3: CONTACTO Y EXTRAS -->
                <div *ngIf="currentStep === 3" class="wizard-step fade-in">
                    <!-- REDES DE CONTACTO -->
                    <div class="form-section">
                        <h3 class="section-heading"><span class="label-icon">üì≤</span> Canales de Contacto</h3>

                        <div class="checkbox-group">
                            <label class="checkbox-header">
                                <input type="checkbox" [(ngModel)]="modernData.hasWhatsapp">
                                <span class="custom-checkbox"></span>
                                <span class="checkbox-label">WhatsApp</span>
                            </label>
                            <div class="contact-inputs whatsapp-row" *ngIf="modernData.hasWhatsapp">
                                <div class="custom-flag-select">
                                    <div class="selected-flag" (click)="toggleCountryDropdown()">
                                        <img [src]="'https://flagcdn.com/w20/' + selectedCountry.iso + '.png'"
                                            width="20" alt="flag">
                                        <span class="country-code">{{selectedCountry.code}}</span>
                                        <span class="dropdown-arrow">‚ñº</span>
                                    </div>
                                    <div class="flag-dropdown-list" *ngIf="showCountryDropdown">
                                        <div class="flag-option" *ngFor="let country of countryCodes"
                                            (click)="selectCountry(country)">
                                            <img [src]="'https://flagcdn.com/w20/' + country.iso + '.png'" width="20"
                                                alt="flag">
                                            <span class="country-name">{{country.name}}</span>
                                            <span class="country-code">{{country.code}}</span>
                                        </div>
                                    </div>
                                </div>
                                <input type="text" class="form-input" [(ngModel)]="modernData.whatsapp"
                                    placeholder="Ej: 9 11 1234-5678">
                            </div>
                        </div>

                        <div class="checkbox-group">
                            <label class="checkbox-header">
                                <input type="checkbox" [(ngModel)]="modernData.hasInstagram">
                                <span class="custom-checkbox"></span>
                                <span class="checkbox-label">Instagram</span>
                            </label>
                            <div class="contact-inputs" *ngIf="modernData.hasInstagram">
                                <input type="text" class="form-input" [(ngModel)]="modernData.instagram"
                                    placeholder="Ej: @minegocio">
                            </div>
                        </div>
                    </div>

                    <!-- M√âTODOS DE PAGO -->
                    <div class="form-section">
                        <h3 class="section-heading"><span class="label-icon">üí≥</span> M√©todos de Pago</h3>
                        <p class="section-desc">Seleccion√° c√≥mo pueden pagarte e inclu√≠ links o alias opcionales. (Pod√©s
                            marcar uno o varios)</p>

                        <div class="payment-methods-container">
                            <div class="payment-method-block">
                                <label class="toggle-pill">
                                    <input type="checkbox" [(ngModel)]="modernData.pagoTransferencia">
                                    <span class="pill-pad">üì± Transferencia / Billetera Virtual</span>
                                </label>
                                <div class="contact-inputs payment-detail-input" *ngIf="modernData.pagoTransferencia">
                                    <input type="text" class="form-input" [(ngModel)]="modernData.aliasTransferencia"
                                        placeholder="Alias o CVU (Opcional)">
                                </div>
                            </div>

                            <div class="payment-method-block">
                                <label class="toggle-pill">
                                    <input type="checkbox" [(ngModel)]="modernData.pagoTarjeta">
                                    <span class="pill-pad">üí≥ Tarjetas de D√©bito/Cr√©dito</span>
                                </label>
                                <div class="contact-inputs payment-detail-input" *ngIf="modernData.pagoTarjeta">
                                    <input type="text" class="form-input" [(ngModel)]="modernData.linkPagoTarjeta"
                                        placeholder="Link de pago (Opcional)">
                                </div>
                            </div>

                            <div class="toggles-grid mt-2">
                                <label class="toggle-pill">
                                    <input type="checkbox" [(ngModel)]="modernData.pagoLocal">
                                    <span class="pill-pad">üè™ Cobro en Local</span>
                                </label>
                                <label class="toggle-pill">
                                    <input type="checkbox" [(ngModel)]="modernData.pagoEfectivo">
                                    <span class="pill-pad">üíµ Efectivo</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- DETALLES ADICIONALES -->
                    <div class="form-section last-section">
                        <h3 class="section-heading"><span class="label-icon">‚ú®</span> Detalles Adicionales</h3>

                        <div class="toggles-grid">
                            <label class="toggle-pill">
                                <input type="checkbox" [(ngModel)]="modernData.petfriendly">
                                <span class="pill-pad">üê∂ Petfriendly</span>
                            </label>
                            <label class="toggle-pill">
                                <input type="checkbox" [(ngModel)]="modernData.delivery">
                                <span class="pill-pad">üõµ Delivery / Env√≠os</span>
                            </label>
                            <label class="toggle-pill">
                                <input type="checkbox" [(ngModel)]="modernData.retiroLocal">
                                <span class="pill-pad">üõçÔ∏è Retiro en el local</span>
                            </label>
                        </div>
                    </div>

                    <div class="wizard-nav space-between">
                        <button class="btn-prev" (click)="prevStep()">‚Üê Atr√°s</button>
                        <button class="btn-generate wizard-submit" id="btn-generar"
                            [disabled]="isGenerating || (!modernData.nombre.trim() && modernData.productosList.length === 0)"
                            (click)="generateFicha()">
                            <span *ngIf="!isGenerating">{{ t('demo.form.btnGenerate') }}</span>
                            <span *ngIf="isGenerating" class="generating-text">
                                <span class="dot-anim"></span> {{ t('demo.form.btnGenerating') }}
                            </span>
                        </button>
                    </div>
                </div> <!-- END STEP 3 -->
            </div>
        </section>

        <!-- RIGHT ‚Äî PREVIEW -->
        <section class="demo-preview-panel">

            <!-- PLACEHOLDER -->
            <div class="preview-placeholder" *ngIf="!isGenerated && !isGenerating">
                <div class="placeholder-icon">üìã</div>
                <p class="placeholder-title">{{ t('demo.preview.placeholderTitle') }}</p>
                <p class="placeholder-hint">{{ t('demo.preview.placeholderHint') }}</p>
            </div>

            <!-- LOADING -->
            <div class="preview-loading" *ngIf="isGenerating">
                <div class="spinner-ring"></div>
                <p>{{ t('demo.preview.loading') }}</p>
            </div>

            <!-- FICHA RESULT -->
            <div class="ficha-card" *ngIf="isGenerated && fichaResult">

                <!-- ACTION BUTTONS -->
                <div class="ficha-actions">
                    <button class="btn-copy" id="btn-copiar" [class.copied]="isCopied" (click)="copyToClipboard()">
                        <span *ngIf="!isCopied">{{ t('demo.preview.btnCopy') }}</span>
                        <span *ngIf="isCopied">{{ t('demo.preview.btnCopied') }}</span>
                    </button>
                    <button class="btn-reset" id="btn-nueva" (click)="resetDemo()">{{ t('demo.preview.btnReset')
                        }}</button>
                </div>

                <!-- ACTIVAR AGENTE IA -->
                <div class="activar-section">
                    <button class="btn-activar" id="btn-activar" (click)="activarAgente()">
                        <span class="activar-icon">‚ö°</span>
                        {{ t('demo.preview.btnActivate') }}
                        <span class="activar-arrow">‚Üí</span>
                    </button>
                    <p class="activar-hint">{{ t('demo.preview.activateHint') }}</p>
                </div>

                <!-- NOMBRE Y RUBRO -->
                <div class="ficha-header">
                    <h2 class="ficha-nombre">{{ fichaResult.nombre }}</h2>
                    <span class="ficha-rubro">{{ fichaResult.rubro }}</span>
                </div>

                <hr class="ficha-divider" />

                <!-- DESCRIPCI√ìN -->
                <div class="ficha-section">
                    <h3 class="ficha-section-title">{{ t('demo.preview.descTitle') }}</h3>
                    <p class="ficha-text">{{ fichaResult.descripcion }}</p>
                </div>

                <!-- HORARIOS -->
                <div class="ficha-section" *ngIf="fichaResult.horarios.length > 0">
                    <h3 class="ficha-section-title">{{ t('demo.preview.hoursTitle') }}</h3>
                    <div class="horario-row" *ngFor="let h of fichaResult.horarios">
                        <span class="horario-dias">{{ h.dias }}</span>
                        <span class="horario-horas" *ngIf="h.horas">{{ h.horas }}</span>
                    </div>
                </div>

                <!-- UBICACI√ìN -->
                <div class="ficha-section" *ngIf="fichaResult.ubicacion">
                    <h3 class="ficha-section-title">{{ t('demo.preview.locationTitle') }}</h3>
                    <p class="ficha-text">{{ fichaResult.ubicacion }}</p>
                </div>

                <!-- CONTACTO -->
                <div class="ficha-section" *ngIf="fichaResult.contacto.length > 0">
                    <h3 class="ficha-section-title">{{ t('demo.preview.socialTitle') }}</h3>
                    <p class="ficha-text" *ngFor="let c of fichaResult.contacto">{{ c }}</p>
                </div>

                <!-- PRODUCTOS -->
                <div class="ficha-section" *ngIf="fichaResult.productos.length > 0">
                    <h3 class="ficha-section-title">{{ t('demo.preview.menuTitle') }}</h3>
                    <div class="productos-categoria" *ngFor="let cat of fichaResult.productos">
                        <h4 class="categoria-nombre">{{ cat.categoria }}</h4>
                        <div class="producto-row" *ngFor="let item of cat.items">
                            <span class="producto-nombre">{{ item.nombre }}</span>
                            <span class="producto-precio" *ngIf="item.precio">{{ item.precio }}</span>
                        </div>
                    </div>
                </div>

                <!-- DESTACADOS -->
                <div class="ficha-section destacados-section" *ngIf="fichaResult.destacados.length > 0">
                    <h3 class="ficha-section-title">‚≠ê</h3>
                    <div class="destacados-list">
                        <span class="destacado-tag" *ngFor="let d of fichaResult.destacados">{{ d }}</span>
                    </div>
                </div>

            </div>
        </section>
    </main>
</div>